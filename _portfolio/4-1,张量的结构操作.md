# 4-1,Âº†ÈáèÁöÑÁªìÊûÑÊìç‰Ωú

Êú¨ÁØáÊàë‰ª¨‰ªãÁªçÂº†ÈáèÁöÑÁªìÊûÑÊìç‰Ωú„ÄÇ

Âº†ÈáèÁªìÊûÑÊìç‰Ωú‰∏ªË¶ÅÂåÖÊã¨ÔºöÂº†ÈáèÂàõÂª∫ÔºåÁ¥¢ÂºïÂàáÁâáÔºåÁª¥Â∫¶ÂèòÊç¢ÔºåÂêàÂπ∂ÂàÜÂâ≤„ÄÇ





```python
import torch 
print("torch.__version__="+torch.__version__) 
```

    torch.__version__=2.0.1



```python

```

### ‰∏ÄÔºåÂàõÂª∫Âº†Èáè

Âº†ÈáèÂàõÂª∫ÁöÑËÆ∏Â§öÊñπÊ≥ïÂíånumpy‰∏≠ÂàõÂª∫arrayÁöÑÊñπÊ≥ïÂæàÂÉè„ÄÇ


```python
import numpy as np
import torch 
```


```python
a = torch.tensor([1,2,3],dtype = torch.float)
print(a)
```

    tensor([1., 2., 3.])



```python
b = torch.arange(1,10,step = 2)
print(b)
```

    tensor([1, 3, 5, 7, 9])



```python

```


```python
c = torch.linspace(0.0,2*3.14,10)
print(c)
```

    tensor([0.0000, 0.6978, 1.3956, 2.0933, 2.7911, 3.4889, 4.1867, 4.8844, 5.5822,
            6.2800])



```python

```


```python
d = torch.zeros((3,3))
print(d)
```

    tensor([[0., 0., 0.],
            [0., 0., 0.],
            [0., 0., 0.]])



```python

```


```python
a = torch.ones((3,3),dtype = torch.int)
b = torch.zeros_like(a,dtype = torch.float)
print(a)
print(b)

```

    tensor([[1, 1, 1],
            [1, 1, 1],
            [1, 1, 1]], dtype=torch.int32)
    tensor([[0., 0., 0.],
            [0., 0., 0.],
            [0., 0., 0.]])



```python

```


```python
torch.fill_(b,5)
print(b)
```

    tensor([[5., 5., 5.],
            [5., 5., 5.],
            [5., 5., 5.]])



```python

```


```python
#ÂùáÂåÄÈöèÊú∫ÂàÜÂ∏É
torch.manual_seed(0)
minval,maxval = 0,10
a = minval + (maxval-minval)*torch.rand([5])
print(a)
```

    tensor([4.9626, 7.6822, 0.8848, 1.3203, 3.0742])



```python

```


```python
#Ê≠£ÊÄÅÂàÜÂ∏ÉÈöèÊú∫
b = torch.normal(mean = torch.zeros(3,3), std = torch.ones(3,3))
print(b)

```

    tensor([[ 0.5507,  0.2704,  0.6472],
            [ 0.2490, -0.3354,  0.4564],
            [-0.6255,  0.4539, -1.3740]])



```python

```


```python
#Ê≠£ÊÄÅÂàÜÂ∏ÉÈöèÊú∫
mean,std = 2,5
c = std*torch.randn((3,3))+mean
print(c)
```

    tensor([[16.2371, -1.6612,  3.9163],
            [ 7.4999,  1.5616,  4.0768],
            [ 5.2128, -8.9407,  6.4601]])



```python

```


```python
#Êï¥Êï∞ÈöèÊú∫ÊéíÂàó
d = torch.randperm(20)
print(d)
```

    tensor([ 3, 17,  9, 19,  1, 18,  4, 13, 15, 12,  0, 16,  7, 11,  2,  5,  8, 10,
             6, 14])



```python

```


```python
#ÁâπÊÆäÁü©Èòµ
I = torch.eye(3,3) #Âçï‰ΩçÁü©Èòµ
print(I)
t = torch.diag(torch.tensor([1,2,3])) #ÂØπËßíÁü©Èòµ
print(t)

```

    tensor([[1., 0., 0.],
            [0., 1., 0.],
            [0., 0., 1.]])
    tensor([[1, 0, 0],
            [0, 2, 0],
            [0, 0, 3]])



```python

```


```python

```

### ‰∫å ÔºåÁ¥¢ÂºïÂàáÁâá

Âº†ÈáèÁöÑÁ¥¢ÂºïÂàáÁâáÊñπÂºèÂíånumpyÂá†‰πéÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇÂàáÁâáÊó∂ÊîØÊåÅÁº∫ÁúÅÂèÇÊï∞ÂíåÁúÅÁï•Âè∑„ÄÇ

ÂèØ‰ª•ÈÄöËøáÁ¥¢ÂºïÂíåÂàáÁâáÂØπÈÉ®ÂàÜÂÖÉÁ¥†ËøõË°å‰øÆÊîπ„ÄÇ

Ê≠§Â§ñÔºåÂØπ‰∫é‰∏çËßÑÂàôÁöÑÂàáÁâáÊèêÂèñ,ÂèØ‰ª•‰ΩøÁî®torch.index_select, torch.masked_select, torch.take

Â¶ÇÊûúË¶ÅÈÄöËøá‰øÆÊîπÂº†ÈáèÁöÑÊüê‰∫õÂÖÉÁ¥†ÂæóÂà∞Êñ∞ÁöÑÂº†ÈáèÔºåÂèØ‰ª•‰ΩøÁî®torch.where,torch.masked_fill,torch.index_fill


```python
#ÂùáÂåÄÈöèÊú∫ÂàÜÂ∏É
torch.manual_seed(0)
minval,maxval = 0,10
t = torch.floor(minval + (maxval-minval)*torch.rand([5,5])).int()
print(t)

```

    tensor([[4, 7, 0, 1, 3],
            [6, 4, 8, 4, 6],
            [3, 4, 0, 1, 2],
            [5, 6, 8, 1, 2],
            [6, 9, 3, 8, 4]], dtype=torch.int32)



```python

```


```python
#Á¨¨0Ë°å
print(t[0])
```

    tensor([4, 7, 0, 1, 3], dtype=torch.int32)



```python

```


```python
#ÂÄíÊï∞Á¨¨‰∏ÄË°å
print(t[-1])
```

    tensor([6, 9, 3, 8, 4], dtype=torch.int32)



```python

```


```python
#Á¨¨1Ë°åÁ¨¨3Âàó
print(t[1,3])
print(t[1][3])
```

    tensor(4, dtype=torch.int32)
    tensor(4, dtype=torch.int32)



```python

```


```python
#Á¨¨1Ë°åËá≥Á¨¨3Ë°å
print(t[1:4,:])
```

    tensor([[6, 4, 8, 4, 6],
            [3, 4, 0, 1, 2],
            [5, 6, 8, 1, 2]], dtype=torch.int32)



```python
#Á¨¨1Ë°åËá≥ÊúÄÂêé‰∏ÄË°åÔºåÁ¨¨0ÂàóÂà∞ÊúÄÂêé‰∏ÄÂàóÊØèÈöî‰∏§ÂàóÂèñ‰∏ÄÂàó
print(t[1:4,:4:2])

```

    tensor([[6, 8],
            [3, 0],
            [5, 8]], dtype=torch.int32)



```python

```


```python
#ÂèØ‰ª•‰ΩøÁî®Á¥¢ÂºïÂíåÂàáÁâá‰øÆÊîπÈÉ®ÂàÜÂÖÉÁ¥†
x = torch.Tensor([[1,2],[3,4]])
x.data[1,:] = torch.tensor([0.0,0.0])
x
```




    tensor([[1., 2.],
            [0., 0.]])




```python

```


```python
a = torch.arange(27).view(3,3,3)
print(a)
```

    tensor([[[ 0,  1,  2],
             [ 3,  4,  5],
             [ 6,  7,  8]],
    
            [[ 9, 10, 11],
             [12, 13, 14],
             [15, 16, 17]],
    
            [[18, 19, 20],
             [21, 22, 23],
             [24, 25, 26]]])



```python
#ÁúÅÁï•Âè∑ÂèØ‰ª•Ë°®Á§∫Â§ö‰∏™ÂÜíÂè∑
print(a[...,1])
```

    tensor([[ 1,  4,  7],
            [10, 13, 16],
            [19, 22, 25]])



```python

```

‰ª•‰∏äÂàáÁâáÊñπÂºèÁõ∏ÂØπËßÑÂàôÔºåÂØπ‰∫é‰∏çËßÑÂàôÁöÑÂàáÁâáÊèêÂèñ,ÂèØ‰ª•‰ΩøÁî®torch.index_select, torch.take, torch.gather, torch.masked_select.

ËÄÉËôëÁè≠Á∫ßÊàêÁª©ÂÜåÁöÑ‰æãÂ≠êÔºåÊúâ4‰∏™Áè≠Á∫ßÔºåÊØè‰∏™Áè≠Á∫ß5‰∏™Â≠¶ÁîüÔºåÊØè‰∏™Â≠¶Áîü7Èó®ÁßëÁõÆÊàêÁª©„ÄÇÂèØ‰ª•Áî®‰∏Ä‰∏™4√ó5√ó7ÁöÑÂº†ÈáèÊù•Ë°®Á§∫„ÄÇ



```python
minval=0
maxval=100
scores = torch.floor(minval + (maxval-minval)*torch.rand([4,5,7])).int()
print(scores)
```

    tensor([[[55, 95,  3, 18, 37, 30, 93],
             [17, 26, 15,  3, 20, 92, 72],
             [74, 52, 24, 58,  3, 13, 24],
             [81, 79, 27, 48, 81, 99, 69],
             [56, 83, 20, 59, 11, 15, 24]],
    
            [[72, 70, 20, 65, 77, 43, 51],
             [61, 81, 98, 11, 31, 69, 91],
             [93, 94, 59,  6, 54, 18,  3],
             [94, 88,  0, 59, 41, 41, 27],
             [69, 20, 68, 75, 85, 68,  0]],
    
            [[17, 74, 60, 10, 21, 97, 83],
             [28, 37,  2, 49, 12, 11, 47],
             [57, 29, 79, 19, 95, 84,  7],
             [37, 52, 57, 61, 69, 52, 25],
             [73,  2, 20, 37, 25, 32,  9]],
    
            [[39, 60, 17, 47, 85, 44, 51],
             [45, 60, 81, 97, 81, 97, 46],
             [ 5, 26, 84, 49, 25, 11,  3],
             [ 7, 39, 77, 77,  1, 81, 10],
             [39, 29, 40, 40,  5,  6, 42]]], dtype=torch.int32)



```python
#ÊäΩÂèñÊØè‰∏™Áè≠Á∫ßÁ¨¨0‰∏™Â≠¶ÁîüÔºåÁ¨¨2‰∏™Â≠¶ÁîüÔºåÁ¨¨4‰∏™Â≠¶ÁîüÁöÑÂÖ®ÈÉ®ÊàêÁª©
torch.index_select(scores,dim = 1,index = torch.tensor([0,2,4]))

```




    tensor([[[55, 95,  3, 18, 37, 30, 93],
             [74, 52, 24, 58,  3, 13, 24],
             [56, 83, 20, 59, 11, 15, 24]],
    
            [[72, 70, 20, 65, 77, 43, 51],
             [93, 94, 59,  6, 54, 18,  3],
             [69, 20, 68, 75, 85, 68,  0]],
    
            [[17, 74, 60, 10, 21, 97, 83],
             [57, 29, 79, 19, 95, 84,  7],
             [73,  2, 20, 37, 25, 32,  9]],
    
            [[39, 60, 17, 47, 85, 44, 51],
             [ 5, 26, 84, 49, 25, 11,  3],
             [39, 29, 40, 40,  5,  6, 42]]], dtype=torch.int32)




```python
#ÊäΩÂèñÊØè‰∏™Áè≠Á∫ßÁ¨¨0‰∏™Â≠¶ÁîüÔºåÁ¨¨2‰∏™Â≠¶ÁîüÔºåÁ¨¨4‰∏™Â≠¶ÁîüÁöÑÁ¨¨1Èó®ËØæÁ®ãÔºåÁ¨¨3Èó®ËØæÁ®ãÔºåÁ¨¨6Èó®ËØæÁ®ãÊàêÁª©
q = torch.index_select(torch.index_select(scores,dim = 1,index = torch.tensor([0,2,4]))
                   ,dim=2,index = torch.tensor([1,3,6]))
print(q)
```

    tensor([[[95, 18, 93],
             [52, 58, 24],
             [83, 59, 24]],
    
            [[70, 65, 51],
             [94,  6,  3],
             [20, 75,  0]],
    
            [[74, 10, 83],
             [29, 19,  7],
             [ 2, 37,  9]],
    
            [[60, 47, 51],
             [26, 49,  3],
             [29, 40, 42]]], dtype=torch.int32)



```python
#ÊäΩÂèñÁ¨¨0‰∏™Áè≠Á∫ßÁ¨¨0‰∏™Â≠¶ÁîüÁöÑÁ¨¨0Èó®ËØæÁ®ãÔºåÁ¨¨2‰∏™Áè≠Á∫ßÁöÑÁ¨¨3‰∏™Â≠¶ÁîüÁöÑÁ¨¨1Èó®ËØæÁ®ãÔºåÁ¨¨3‰∏™Áè≠Á∫ßÁöÑÁ¨¨4‰∏™Â≠¶ÁîüÁ¨¨6Èó®ËØæÁ®ãÊàêÁª©
#takeÂ∞ÜËæìÂÖ•ÁúãÊàê‰∏ÄÁª¥Êï∞ÁªÑÔºåËæìÂá∫ÂíåindexÂêåÂΩ¢Áä∂
s = torch.take(scores,torch.tensor([0*5*7+0,2*5*7+3*7+1,3*5*7+4*7+6]))
s
```




    tensor([55, 52, 42], dtype=torch.int32)




```python
#ÊäΩÂèñÂàÜÊï∞Â§ß‰∫éÁ≠â‰∫é80ÂàÜÁöÑÂàÜÊï∞ÔºàÂ∏ÉÂ∞îÁ¥¢ÂºïÔºâ
#ÁªìÊûúÊòØ1Áª¥Âº†Èáè
g = torch.masked_select(scores,scores>=80)
print(g)

```

    tensor([95, 93, 92, 81, 81, 99, 83, 81, 98, 91, 93, 94, 94, 88, 85, 97, 83, 95,
            84, 85, 81, 97, 81, 97, 84, 81], dtype=torch.int32)



```python

```

‰ª•‰∏äËøô‰∫õÊñπÊ≥ï‰ªÖËÉΩÊèêÂèñÂº†ÈáèÁöÑÈÉ®ÂàÜÂÖÉÁ¥†ÂÄºÔºå‰ΩÜ‰∏çËÉΩÊõ¥ÊîπÂº†ÈáèÁöÑÈÉ®ÂàÜÂÖÉÁ¥†ÂÄºÂæóÂà∞Êñ∞ÁöÑÂº†Èáè„ÄÇ

Â¶ÇÊûúË¶ÅÈÄöËøá‰øÆÊîπÂº†ÈáèÁöÑÈÉ®ÂàÜÂÖÉÁ¥†ÂÄºÂæóÂà∞Êñ∞ÁöÑÂº†ÈáèÔºåÂèØ‰ª•‰ΩøÁî®torch.where,torch.index_fill Âíå torch.masked_fill

torch.whereÂèØ‰ª•ÁêÜËß£‰∏∫ifÁöÑÂº†ÈáèÁâàÊú¨„ÄÇ

torch.index_fillÁöÑÈÄâÂèñÂÖÉÁ¥†ÈÄªËæëÂíåtorch.index_selectÁõ∏Âêå„ÄÇ

torch.masked_fillÁöÑÈÄâÂèñÂÖÉÁ¥†ÈÄªËæëÂíåtorch.masked_selectÁõ∏Âêå„ÄÇ



```python
#Â¶ÇÊûúÂàÜÊï∞Â§ß‰∫é60ÂàÜÔºåËµãÂÄºÊàê1ÔºåÂê¶ÂàôËµãÂÄºÊàê0
ifpass = torch.where(scores>60,torch.tensor(1),torch.tensor(0))
print(ifpass)

```

    tensor([[[0, 1, 0, 0, 0, 0, 1],
             [0, 0, 0, 0, 0, 1, 1],
             [1, 0, 0, 0, 0, 0, 0],
             [1, 1, 0, 0, 1, 1, 1],
             [0, 1, 0, 0, 0, 0, 0]],
    
            [[1, 1, 0, 1, 1, 0, 0],
             [1, 1, 1, 0, 0, 1, 1],
             [1, 1, 0, 0, 0, 0, 0],
             [1, 1, 0, 0, 0, 0, 0],
             [1, 0, 1, 1, 1, 1, 0]],
    
            [[0, 1, 0, 0, 0, 1, 1],
             [0, 0, 0, 0, 0, 0, 0],
             [0, 0, 1, 0, 1, 1, 0],
             [0, 0, 0, 1, 1, 0, 0],
             [1, 0, 0, 0, 0, 0, 0]],
    
            [[0, 0, 0, 0, 1, 0, 0],
             [0, 0, 1, 1, 1, 1, 0],
             [0, 0, 1, 0, 0, 0, 0],
             [0, 0, 1, 1, 0, 1, 0],
             [0, 0, 0, 0, 0, 0, 0]]])



```python

```


```python
#Â∞ÜÊØè‰∏™Áè≠Á∫ßÁ¨¨0‰∏™Â≠¶ÁîüÔºåÁ¨¨2‰∏™Â≠¶ÁîüÔºåÁ¨¨4‰∏™Â≠¶ÁîüÁöÑÂÖ®ÈÉ®ÊàêÁª©ËµãÂÄºÊàêÊª°ÂàÜ
torch.index_fill(scores,dim = 1,index = torch.tensor([0,2,4]),value = 100)
#Á≠â‰ª∑‰∫é scores.index_fill(dim = 1,index = torch.tensor([0,2,4]),value = 100)

```




    tensor([[[100, 100, 100, 100, 100, 100, 100],
             [ 17,  26,  15,   3,  20,  92,  72],
             [100, 100, 100, 100, 100, 100, 100],
             [ 81,  79,  27,  48,  81,  99,  69],
             [100, 100, 100, 100, 100, 100, 100]],
    
            [[100, 100, 100, 100, 100, 100, 100],
             [ 61,  81,  98,  11,  31,  69,  91],
             [100, 100, 100, 100, 100, 100, 100],
             [ 94,  88,   0,  59,  41,  41,  27],
             [100, 100, 100, 100, 100, 100, 100]],
    
            [[100, 100, 100, 100, 100, 100, 100],
             [ 28,  37,   2,  49,  12,  11,  47],
             [100, 100, 100, 100, 100, 100, 100],
             [ 37,  52,  57,  61,  69,  52,  25],
             [100, 100, 100, 100, 100, 100, 100]],
    
            [[100, 100, 100, 100, 100, 100, 100],
             [ 45,  60,  81,  97,  81,  97,  46],
             [100, 100, 100, 100, 100, 100, 100],
             [  7,  39,  77,  77,   1,  81,  10],
             [100, 100, 100, 100, 100, 100, 100]]], dtype=torch.int32)




```python
#Â∞ÜÂàÜÊï∞Â∞è‰∫é60ÂàÜÁöÑÂàÜÊï∞ËµãÂÄºÊàê60ÂàÜ
b = torch.masked_fill(scores,scores<60,60)
#Á≠â‰ª∑‰∫éb = scores.masked_fill(scores<60,60)
b

```




    tensor([[[60, 95, 60, 60, 60, 60, 93],
             [60, 60, 60, 60, 60, 92, 72],
             [74, 60, 60, 60, 60, 60, 60],
             [81, 79, 60, 60, 81, 99, 69],
             [60, 83, 60, 60, 60, 60, 60]],
    
            [[72, 70, 60, 65, 77, 60, 60],
             [61, 81, 98, 60, 60, 69, 91],
             [93, 94, 60, 60, 60, 60, 60],
             [94, 88, 60, 60, 60, 60, 60],
             [69, 60, 68, 75, 85, 68, 60]],
    
            [[60, 74, 60, 60, 60, 97, 83],
             [60, 60, 60, 60, 60, 60, 60],
             [60, 60, 79, 60, 95, 84, 60],
             [60, 60, 60, 61, 69, 60, 60],
             [73, 60, 60, 60, 60, 60, 60]],
    
            [[60, 60, 60, 60, 85, 60, 60],
             [60, 60, 81, 97, 81, 97, 60],
             [60, 60, 84, 60, 60, 60, 60],
             [60, 60, 77, 77, 60, 81, 60],
             [60, 60, 60, 60, 60, 60, 60]]], dtype=torch.int32)




```python

```

### ‰∏âÔºåÁª¥Â∫¶ÂèòÊç¢

Áª¥Â∫¶ÂèòÊç¢Áõ∏ÂÖ≥ÂáΩÊï∞‰∏ªË¶ÅÊúâ torch.reshape(ÊàñËÄÖË∞ÉÁî®Âº†ÈáèÁöÑviewÊñπÊ≥ï), torch.squeeze, torch.unsqueeze, torch.transpose

torch.reshape ÂèØ‰ª•ÊîπÂèòÂº†ÈáèÁöÑÂΩ¢Áä∂„ÄÇ

torch.squeeze ÂèØ‰ª•ÂáèÂ∞ëÁª¥Â∫¶„ÄÇ

torch.unsqueeze ÂèØ‰ª•Â¢ûÂä†Áª¥Â∫¶„ÄÇ

torch.transpose/torch.permute ÂèØ‰ª•‰∫§Êç¢Áª¥Â∫¶„ÄÇ



```python
# Âº†ÈáèÁöÑviewÊñπÊ≥ïÊúâÊó∂ÂÄô‰ºöË∞ÉÁî®Â§±Ë¥•ÔºåÂèØ‰ª•‰ΩøÁî®reshapeÊñπÊ≥ï„ÄÇ

torch.manual_seed(0)
minval,maxval = 0,255
a = (minval + (maxval-minval)*torch.rand([1,3,3,2])).int()
print(a.shape)
print(a)

```

    torch.Size([1, 3, 3, 2])
    tensor([[[[126, 195],
              [ 22,  33],
              [ 78, 161]],
    
             [[124, 228],
              [116, 161],
              [ 88, 102]],
    
             [[  5,  43],
              [ 74, 132],
              [177, 204]]]], dtype=torch.int32)



```python
# ÊîπÊàê Ôºà3,6ÔºâÂΩ¢Áä∂ÁöÑÂº†Èáè
b = a.view([3,6]) #torch.reshape(a,[3,6])
print(b.shape)
print(b)


```

    torch.Size([3, 6])
    tensor([[126, 195,  22,  33,  78, 161],
            [124, 228, 116, 161,  88, 102],
            [  5,  43,  74, 132, 177, 204]], dtype=torch.int32)



```python
# ÊîπÂõûÊàê [1,3,3,2] ÂΩ¢Áä∂ÁöÑÂº†Èáè
c = torch.reshape(b,[1,3,3,2]) # b.view([1,3,3,2]) 
print(c)
```

    tensor([[[[126, 195],
              [ 22,  33],
              [ 78, 161]],
    
             [[124, 228],
              [116, 161],
              [ 88, 102]],
    
             [[  5,  43],
              [ 74, 132],
              [177, 204]]]], dtype=torch.int32)



```python

```

Â¶ÇÊûúÂº†ÈáèÂú®Êüê‰∏™Áª¥Â∫¶‰∏äÂè™Êúâ‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÂà©Áî®torch.squeezeÂèØ‰ª•Ê∂àÈô§Ëøô‰∏™Áª¥Â∫¶„ÄÇ

torch.unsqueezeÁöÑ‰ΩúÁî®Âíåtorch.squeezeÁöÑ‰ΩúÁî®Áõ∏Âèç„ÄÇ


```python
a = torch.tensor([[1.0,2.0]])
s = torch.squeeze(a)
print(a)
print(s)
print(a.shape)
print(s.shape)

```

    tensor([[1., 2.]])
    tensor([1., 2.])
    torch.Size([1, 2])
    torch.Size([2])



```python
#Âú®Á¨¨0Áª¥ÊèíÂÖ•ÈïøÂ∫¶‰∏∫1ÁöÑ‰∏Ä‰∏™Áª¥Â∫¶

d = torch.unsqueeze(s,axis=0)  
print(s)
print(d)

print(s.shape)
print(d.shape)

```

    tensor([1., 2.])
    tensor([[1., 2.]])
    torch.Size([2])
    torch.Size([1, 2])



```python

```

torch.transposeÂèØ‰ª•‰∫§Êç¢Âº†ÈáèÁöÑÁª¥Â∫¶Ôºåtorch.transposeÂ∏∏Áî®‰∫éÂõæÁâáÂ≠òÂÇ®Ê†ºÂºèÁöÑÂèòÊç¢‰∏ä„ÄÇ

Â¶ÇÊûúÊòØ‰∫åÁª¥ÁöÑÁü©ÈòµÔºåÈÄöÂ∏∏‰ºöË∞ÉÁî®Áü©ÈòµÁöÑËΩ¨ÁΩÆÊñπÊ≥ï matrix.t()ÔºåÁ≠â‰ª∑‰∫é torch.transpose(matrix,0,1)„ÄÇ



```python
minval=0
maxval=255
# Batch,Height,Width,Channel
data = torch.floor(minval + (maxval-minval)*torch.rand([100,256,256,4])).int()
print(data.shape)

# ËΩ¨Êç¢Êàê PytorchÈªòËÆ§ÁöÑÂõæÁâáÊ†ºÂºè Batch,Channel,Height,Width 
# ÈúÄË¶Å‰∫§Êç¢‰∏§Ê¨°
data_t = torch.transpose(torch.transpose(data,1,2),1,3)
print(data_t.shape)


data_p = torch.permute(data,[0,3,1,2]) #ÂØπÁª¥Â∫¶ÁöÑÈ°∫Â∫èÂÅöÈáçÊñ∞ÁºñÊéí
data_p.shape 

```

    torch.Size([100, 256, 256, 4])
    torch.Size([100, 4, 256, 256])





    torch.Size([100, 4, 256, 256])




```python

```


```python
matrix = torch.tensor([[1,2,3],[4,5,6]])
print(matrix)
print(matrix.t()) #Á≠â‰ª∑‰∫étorch.transpose(matrix,0,1)


```

    tensor([[1, 2, 3],
            [4, 5, 6]])
    tensor([[1, 4],
            [2, 5],
            [3, 6]])



```python

```

### ÂõõÔºåÂêàÂπ∂ÂàÜÂâ≤

ÂèØ‰ª•Áî®torch.catÊñπÊ≥ïÂíåtorch.stackÊñπÊ≥ïÂ∞ÜÂ§ö‰∏™Âº†ÈáèÂêàÂπ∂ÔºåÂèØ‰ª•Áî®torch.splitÊñπÊ≥ïÊää‰∏Ä‰∏™Âº†ÈáèÂàÜÂâ≤ÊàêÂ§ö‰∏™Âº†Èáè„ÄÇ

torch.catÂíåtorch.stackÊúâÁï•ÂæÆÁöÑÂå∫Âà´Ôºåtorch.catÊòØËøûÊé•Ôºå‰∏ç‰ºöÂ¢ûÂä†Áª¥Â∫¶ÔºåËÄåtorch.stackÊòØÂ†ÜÂè†Ôºå‰ºöÂ¢ûÂä†Áª¥Â∫¶„ÄÇ



```python
a = torch.tensor([[1.0,2.0],[3.0,4.0]])
b = torch.tensor([[5.0,6.0],[7.0,8.0]])
c = torch.tensor([[9.0,10.0],[11.0,12.0]])

abc_cat = torch.cat([a,b,c],dim = 0)
print(abc_cat.shape)
print(abc_cat)

```

    torch.Size([6, 2])
    tensor([[ 1.,  2.],
            [ 3.,  4.],
            [ 5.,  6.],
            [ 7.,  8.],
            [ 9., 10.],
            [11., 12.]])



```python
abc_stack = torch.stack([a,b,c],axis = 0) #torch‰∏≠dimÂíåaxisÂèÇÊï∞ÂêçÂèØ‰ª•Ê∑∑Áî®
print(abc_stack.shape)
print(abc_stack)

```

    torch.Size([3, 2, 2])
    tensor([[[ 1.,  2.],
             [ 3.,  4.]],
    
            [[ 5.,  6.],
             [ 7.,  8.]],
    
            [[ 9., 10.],
             [11., 12.]]])



```python
torch.cat([a,b,c],axis = 1)

```




    tensor([[ 1.,  2.,  5.,  6.,  9., 10.],
            [ 3.,  4.,  7.,  8., 11., 12.]])




```python
torch.stack([a,b,c],axis = 1)
```




    tensor([[[ 1.,  2.],
             [ 5.,  6.],
             [ 9., 10.]],
    
            [[ 3.,  4.],
             [ 7.,  8.],
             [11., 12.]]])



torch.splitÊòØtorch.catÁöÑÈÄÜËøêÁÆóÔºåÂèØ‰ª•ÊåáÂÆöÂàÜÂâ≤‰ªΩÊï∞Âπ≥ÂùáÂàÜÂâ≤Ôºå‰πüÂèØ‰ª•ÈÄöËøáÊåáÂÆöÊØè‰ªΩÁöÑËÆ∞ÂΩïÊï∞ÈáèËøõË°åÂàÜÂâ≤„ÄÇ


```python
print(abc_cat)
a,b,c = torch.split(abc_cat,split_size_or_sections = 2,dim = 0) #ÊØè‰ªΩ2‰∏™ËøõË°åÂàÜÂâ≤
print(a)
print(b)
print(c)
```

    tensor([[ 1.,  2.],
            [ 3.,  4.],
            [ 5.,  6.],
            [ 7.,  8.],
            [ 9., 10.],
            [11., 12.]])
    tensor([[1., 2.],
            [3., 4.]])
    tensor([[5., 6.],
            [7., 8.]])
    tensor([[ 9., 10.],
            [11., 12.]])



```python
print(abc_cat)
p,q,r = torch.split(abc_cat,split_size_or_sections =[4,1,1],dim = 0) #ÊØè‰ªΩÂàÜÂà´‰∏∫[4,1,1]
print(p)
print(q)
print(r)
```

    tensor([[ 1.,  2.],
            [ 3.,  4.],
            [ 5.,  6.],
            [ 7.,  8.],
            [ 9., 10.],
            [11., 12.]])
    tensor([[1., 2.],
            [3., 4.],
            [5., 6.],
            [7., 8.]])
    tensor([[ 9., 10.]])
    tensor([[11., 12.]])



```python

```

**Â¶ÇÊûúÊú¨‰π¶ÂØπ‰Ω†ÊúâÊâÄÂ∏ÆÂä©ÔºåÊÉ≥ÈºìÂä±‰∏Ä‰∏ã‰ΩúËÄÖÔºåËÆ∞ÂæóÁªôÊú¨È°πÁõÆÂä†‰∏ÄÈ¢óÊòüÊòüstar‚≠êÔ∏èÔºåÂπ∂ÂàÜ‰∫´Áªô‰Ω†ÁöÑÊúãÂèã‰ª¨Âñîüòä!** 

Â¶ÇÊûúÂØπÊú¨‰π¶ÂÜÖÂÆπÁêÜËß£‰∏äÊúâÈúÄË¶ÅËøõ‰∏ÄÊ≠•Âíå‰ΩúËÄÖ‰∫§ÊµÅÁöÑÂú∞ÊñπÔºåÊ¨¢ËøéÂú®ÂÖ¨‰ºóÂè∑"ÁÆóÊ≥ïÁæéÈ£üÂ±ã"‰∏ãÁïôË®Ä„ÄÇ‰ΩúËÄÖÊó∂Èó¥ÂíåÁ≤æÂäõÊúâÈôêÔºå‰ºöÈÖåÊÉÖ‰∫à‰ª•ÂõûÂ§ç„ÄÇ

‰πüÂèØ‰ª•Âú®ÂÖ¨‰ºóÂè∑ÂêéÂè∞ÂõûÂ§çÂÖ≥ÈîÆÂ≠óÔºö**Âä†Áæ§**ÔºåÂä†ÂÖ•ËØªËÄÖ‰∫§ÊµÅÁæ§ÂíåÂ§ßÂÆ∂ËÆ®ËÆ∫„ÄÇ

![ÁÆóÊ≥ïÁæéÈ£üÂ±ãlogo.png](https://tva1.sinaimg.cn/large/e6c9d24egy1h41m2zugguj20k00b9q46.jpg)
